<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>月类型销量</title>
		<script src="js/echarts.min.js"></script>
		<script src="js/jquery.js"></script>
		<link rel="stylesheet" href="css/screen.css" />
		<style type="text/css">
			* {
				margin: 0px;
				padding: 0px;
			}
			#main {
				height: 400px;
				width: 90%;
				position: absolute;
				left: 5%;
				top: 100px;
			}
			.menu {
				width: 100%;
				height: 80px;
				position: absolute;
			}
		</style>
	</head>
	<body onload="getData()">
		<div class="menu">
			<select class="selectSizeYear">
				<option value="2015">2015</option>
				<option value="2016">2016</option>
				<option value="2017">2017</option>
				<option value="2018">2018</option>
				<option value="2019">2019</option>
				<option value="2020" selected="selected">2020</option>
				<option value="2021">2021</option>
			</select>
			<select class="selectSizeMonth">
				<option value="01">01</option>
				<option value="02">02</option>
				<option value="03">03</option>
				<option value="04">04</option>
				<option value="05">05</option>
				<option value="06">06</option>
				<option value="07">07</option>
				<option value="08" selected="selected">08</option>
				<option value="09">09</option>
				<option value="10">10</option>
				<option value="11">11</option>
				<option value="12">12</option>
			</select>
			<input class="buttonSize" type="button" value="查询" onclick="getData()"/>
		</div>
		<div id="main"></div>
		<script>
			function getData() {
				//获取选择时间
				var year = $(".selectSizeYear")[0];
				var y = year.options[year.selectedIndex].value;
				var month = $(".selectSizeMonth")[0];
				var m = month.options[month.selectedIndex].value;
				$.ajax({
					type:"POST",
					url:"MonthTypeVolumeServlet",
					data:{
						year: y,
						month: m
					},
					success:function(data) {
						var car_type = new Array();
						var sales_data = new Array();
						var jsData = JSON.parse(data);
						for(var i=0; i<jsData.length; i++) {
							car_type[i] = jsData[i].car_type;
							sales_data[i] = jsData[i].sales_data;
						}
						test(car_type, sales_data);
					}
				});
			}
			function test(car_type, sales_data) {
				var myChart = echarts.init(document.getElementById("main"))
			
				  // 指定图表的配置项和数据
		        var option = {
		            title: {
		                text: '月度汽车类型成交量Top10'
		            },
		            tooltip: {},
		            legend: {
		                data:['销量']
		            },
		            xAxis: [{
		            	data: car_type,
		            	axisLabel:{
		           			//设置成 0 强制显示所有标签。
		           			rotate:45,
		           			interval: 0
		           		}
		            }],
		            yAxis: {},
		            series: [{
		                name: '成交量',
		                type: 'bar',
		                data: sales_data
		            }]
		        };
		        // 使用刚指定的配置项和数据显示图表。
		        myChart.setOption(option);
	        }
		</script>
	</body>
</html>
